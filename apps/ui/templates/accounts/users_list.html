{% extends "base.html" %}
{% block title %}Utilisateurs{% endblock %}

{% block content %}
<h3 class="page-title mb-3">
  <span class="dot"><i class="bi bi-people"></i></span>
  Utilisateurs
</h3>

<div class="d-flex justify-content-between align-items-center mb-3">
  <div class="text-muted">Total : <strong>{{ users|length }}</strong></div>
  <a href="{% url 'accounts:user_create' %}" class="btn btn-primary">
    <i class="bi bi-person-plus me-1"></i> Nouvel utilisateur
  </a>
</div>

<div class="table-responsive">
  <table class="table table-modern align-middle">
    <thead>
      <tr>
        <th>Username</th>
        <th>Email</th>
        <th>Rôle</th>
        <th>Actif</th>
        <th>Inscription</th>
        <th>Dernière connexion</th>
        <th class="text-end">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.username }}</td>
        <td>{{ u.email|default:"—" }}</td>
        <td>
          {% if u.is_staff %}
            <span class="badge bg-primary-subtle text-primary">Admin</span>
          {% else %}
            <span class="badge bg-secondary-subtle text-secondary">User</span>
          {% endif %}
        </td>
        <td>
          {% if u.is_active %}
            <span class="badge bg-success-subtle text-success">Actif</span>
          {% else %}
            <span class="badge bg-danger-subtle text-danger">Inactif</span>
          {% endif %}
        </td>
        <td>{{ u.date_joined|date:"Y-m-d H:i" }}</td>
        <td>{{ u.last_login|date:"Y-m-d H:i"|default:"—" }}</td>
        <td class="text-end">
          <a href="{% url 'accounts:user_edit' u.id %}" class="btn btn-soft btn-sm">
            <i class="bi bi-pencil-square"></i>
          </a>
          <a href="{% url 'accounts:user_toggle_active' u.id %}" class="btn btn-soft btn-sm">
  {% if u.is_active %}
    <i class="bi bi-person-dash text-danger" title="Désactiver"></i>
  {% else %}
    <i class="bi bi-person-check text-success" title="Activer"></i>
  {% endif %}
</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="7" class="text-muted text-center py-4">Aucun utilisateur.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
